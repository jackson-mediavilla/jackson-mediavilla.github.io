<!DOCTYPE html>
<html>

<head>
    <title>Sabermetrics Final Project</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/3/w3.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

    <!-- Script adapted from code found at https://www.codingforums.com/javascript-programming/158863-search-csv-file.html --> 
    <script type="text/javascript">
        var DB = new Array();
        function MakeDB() {
            $(document).ready(function () {
                $.ajax({
                    type: "GET",
                    url: "/data/PlayerData.csv",
                    dataType: "text",
                    async: false,
                    success: function (csvd) {
                        data = $.csv.toArrays(csvd);
                    },
                    error: function(xhr, ajaxOptions, thrownError) {
                        alert("Status: " + xhr.status + "     Error: " + thrownError);
                    }
                });
            });
        }

        function PlayerSearch(Player) {
            alert(DB.length);
            if (Player.indexOf(" ") != -1) {
                names = Player.split(' ');
            }
            else {
                names = Player;
            }
            var position = -1;
            for (i = 0; i < DB.length; i++) {
                tmp = DB[i].split(',');
                found = true;
                for (j = 0; j < name.length; j++){
                    if (tmp.indexOf(names[j]) == -1) {
                        found = false;
                    }
                }
                if (found == true) {
                    position = i;
                    break;
                }
            }
            if (position == -1) {
                alert('Cannot locate player.');
            }
            else {
                document.getElementById('Results').value = DB[position];
                document.getElementById('Results').style.display = "inline";
            }
        }
    </script>

</head>

<style>
    body, html {
        height: 100%;
    }
</style>

<body onload="MakeDB()">
    <!-- Navigation -->
    <nav class="w3-bar w3-black">
        <ul>
            <a href="/index.html" class="w3-button w3-bar-item">Home</a>
            <a href="/explanation.html" class="w3-button w3-bar-item">Explanation of Statistic</a>
            <a class="w3-button w3-bar-item" style="background-color:darkgray">Use the Tool</a>
            <a href="/analysis.html" class="w3-button w3-bar-item">Analysis</a>
            <a href="/presentation.html" class="w3-button w3-bar-item">Presentation</a>
        </ul>
    </nav>

    <!-- Format background -->
    <div class="w3-black w3-grayscale w3-large">

        <!-- Calculator Container -->
        <div class="w3-container" id="explanation">
            <div class="w3-content w3-padding-64" style="max-width:700px">
                <h3 class="w3-center w3-padding-32"><span class="w3-tag w3-wide">BAPA CALCULATOR</span></h5>
            </div>
            <div class="w3-content w3-padding-32">
                <h4 class="w3-center w3-display-middleleft w3-text-white">Search for a Player.</h6>
                Model:<input type="text" value="" id="PlayerName">
                <input type="button" value="Search" onclick="PlayerSearch(document.getElementById('PlayerName').value)">
                <br>
                <textarea id="Results" rows="5" cols="21" style="display:none"></textarea>
</body>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="w3-center w3-display-bottom w3-dark-grey w3-padding-48 w3-medium">
        <p>View the code for the website and project on my <a href="https://github.com/jackson-mediavilla/jackson-mediavilla.github.io" title="GitHub Repository" target="_blank" class="w3-hover-text-green">GitHub Repository</a>.</p>
    </footer>

</body>
</html>
